<html>
	<head>
		<title>Ex1 Yours</title>
		<script>
		const x = [
			{
				Name: "Alice",
				Score: 100
			},
			{
				Name: "Bob",
				Score: 50
			},
			{
				Name: "Charlie",
				Score: 65
			},
			{
				Name: "Dan",
				Score: 25
			},
			{
				Name: "Eve",
				Score: 100
			}
		];
		
		const classValues = {
			"all": 0,
			"2:2": 50,
			"2:1": 60,
			"1": 70
		};

		function displayList($event)
		{
			let tableBody = document.querySelector('#student-table > tbody')
			let sortValue = document.querySelector('#sort').selectedOptions[0].value;
			let filterValue = document.querySelector('#class').selectedOptions[0].value;
			let filterScore = classValues[filterValue];

			let sortFunction = getSortfunction(sortValue);
			tableBody.innerHTML = '';

			x.filter(student => student.Score >= filterScore).sort(sortFunction).forEach((student, index) => {
				let newRow = document.createElement("tr")
				let name = document.createElement("td")
				name.textContent = student.Name
				let buttonCell = document.createElement("td")
				let button = document.createElement("button")
				button.onclick = () => recordSelected(index)
				buttonCell.appendChild(button)
				let score = document.createElement("td")
				score.textContent = student.Score
				newRow.appendChild(buttonCell)
				newRow.appendChild(name)
				newRow.appendChild(score)
				tableBody.appendChild(newRow)
				
			});
		}

		function recordSelected(index) {
			console.log(index);
		}

		function getSortfunction(key){
			 switch (key) {
				case 'ascending-score':
					return (a,b)=>a.Score - b.Score;
				case 'descending-score':
					return (a,b)=>b.Score-a.Score;
				case 'descending-name':
					return (a,b)=>b.Name.localeCompare(a.Name);
				default:
					return (a,b)=>a.Name.localeCompare(b.Name);
					
			}
		}

		</script>
	</head>
	<body onload="displayList()">
		<select name="sort" id="sort" onchange="displayList()">
			<optgroup label="Score">
				<option value="ascending-score">Ascending</option>
				<option value="descending-score">Descending</option>
			</optgroup>
			<optgroup label="Name">
				<option value="ascending-name">Ascending</option>
				<option value="descending-name">Descending</option>
			</optgroup>
		</select>
		<select name="class" id="class" onchange="displayList()">
			<option value="all">All</option>
			<option value="2:2">2:2 or above</option>
			<option value="2:1">2:1 or above</option>
			<option value="1">1st</option>
		</select>
		<table id="student-table">
			<thead><tr><th></th></tb><th>Name</th><th>Score</th></tr></thead>
			<tbody></tbody>
		</table>
	</body>
</html>